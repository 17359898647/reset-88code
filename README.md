# 88code 每日额度重置

这个项目使用 GitHub Actions 每天自动重置 88code 的免费套餐额度。

## 功能

-   每天 15:45 UTC 时间（北京时间 23:45）自动执行（GitHub Actions 可能有延迟，已避开高峰）
-   支持手动触发
-   使用环境变量管理敏感信息和账户列表
-   支持多个 88code 账户的额度重置
-   兼容中英文逗号分隔的账户 ID 列表

## 配置步骤

### 1. 设置 GitHub Secrets

在 GitHub 仓库中设置以下 Secret：

1. 进入仓库页面
2. 点击 `Settings` -> `Secrets and variables` -> `Actions`
3. 点击 `New repository secret`
4. 添加以下 Secret：

#### 必需配置

-   **Name**: `API_KEY`
-   **Value**: `cr_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx`（不包含 `Bearer ` 前缀）

#### 必需配置

-   **Name**: `ACCOUNT_IDS`
-   **Value**: `12345,67890`（账户 ID 列表，用逗号分隔）

**账户 ID 配置说明**：

-   支持中英文逗号分隔：`12345,67890` 或 `12345，67890`
-   **必须配置此变量**，如果不设置将跳过所有重置操作
-   可以添加更多账户 ID，如：`12345,67890,11111,22222`

### 2. 启用 Actions

1. 确保仓库的 Actions 功能已启用
2. 推送代码到 GitHub 后，Actions 会自动开始工作

## 使用方法

### 自动执行

-   每天 23:45（北京时间）自动执行
-   无需手动干预

### 手动执行

1. 进入 GitHub 仓库的 Actions 页面
2. 选择"88code 每日重置额度"工作流
3. 点击"Run workflow"按钮

## 文件说明

-   `.github/workflows/reset-credits.yml`: GitHub Actions 工作流配置
-   `README.md`: 项目说明文档

## 注意事项

-   **必须配置 ACCOUNT_IDS 环境变量**，否则将跳过所有重置操作
-   **必须配置 API_KEY 环境变量**，其值为以 `cr_` 开头的 Key（不含 `Bearer`）
-   请求时由工作流在头部自动加上 `Authorization: Bearer ${API_KEY}`
-   如需添加或修改账户 ID，更新`ACCOUNT_IDS`环境变量即可
-   工作流使用 UTC 时间，请根据您的时区调整 cron 表达式
-   支持中英文逗号分隔，系统会自动处理
-   具备容错机制，单个账户失败不会影响其他账户的重置

## 容错机制

-   每个账户的重置操作独立执行
-   单个账户失败不会中断其他账户的处理
-   提供详细的成功/失败统计信息
-   请求间有 1 秒延迟，避免过于频繁的 API 调用

## 执行日志示例（HTTP 200 判定成功）

### 成功场景

```
开始重置额度...
使用环境变量账户ID列表: 12345,67890
总共需要重置 2 个账户
正在重置第1个账户 (ID: 12345)...
响应状态码: 200
✅ 账户 12345 额度重置成功
正在重置第2个账户 (ID: 67890)...
✅ 账户 67890 额度重置成功
📊 重置完成统计：
   总账户数: 2
   成功数量: 2
   失败数量: 0
🎉 所有账户额度重置成功！
```

### 部分失败场景

```
开始重置额度...
使用环境变量账户ID列表: 12345,67890
总共需要重置 2 个账户
正在重置第1个账户 (ID: 12345)...
✅ 账户 12345 额度重置成功
正在重置第2个账户 (ID: 67890)...
响应状态码: 401
❌ 账户 67890 额度重置失败
📊 重置完成统计：
   总账户数: 2
   成功数量: 1
   失败数量: 1
⚠️  有 1 个账户重置失败，请检查日志
```

### 未配置账户 ID 场景

```
开始重置额度...
❌ 未配置ACCOUNT_IDS环境变量，跳过重置操作
```
